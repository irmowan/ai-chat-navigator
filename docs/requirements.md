# ChatGPT 对话导航侧边栏 - 需求文档

## 1. 项目概述

### 1.1 项目名称
ChatGPT Turn Navigator - ChatGPT 对话快速定位工具

### 1.2 项目背景
在使用 ChatGPT Web 进行长时间对话时，随着对话轮次（turn）的增加，每个回复内容较长，导致用户难以快速回顾之前提出的问题，需要频繁滚动页面查找历史对话内容，影响使用效率。

### 1.3 项目目标
开发一个浏览器扩展/用户脚本，为 ChatGPT Web 添加对话导航侧边栏，提供快速定位功能，提升用户体验。

## 2. 核心需求

### 2.1 功能需求

#### 2.1.1 侧边栏展示 (P0)
- **需求描述**：在 ChatGPT Web 界面添加一个可见的侧边栏
- **具体要求**：
  - 侧边栏位置：页面右侧或左侧，用户可配置
  - 侧边栏宽度：200-300px，可调节
  - 侧边栏样式：与 ChatGPT 界面风格保持一致

#### 2.1.2 查询列表显示 (P0)
- **需求描述**：以列表形式展示当前对话中所有用户查询（query）
- **具体要求**：
  - 显示内容：用户的每次提问内容
  - 内容截断：过长的查询显示前 50-100 字符，末尾添加省略号
  - 排序方式：按时间顺序从上到下排列（最早的在上方）
  - 序号标识：每个查询前显示序号（如 #1, #2, #3...）
  - 时间戳：可选显示每次提问的时间

#### 2.1.3 快速定位功能 (P0)
- **需求描述**：点击列表中的查询项，页面自动滚动到对应位置
- **具体要求**：
  - 点击响应：点击列表项后立即滚动
  - 定位准确：精确定位到对应的用户查询位置
  - 视觉反馈：滚动完成后高亮显示目标查询（持续 2-3 秒）
  - 平滑滚动：使用平滑动画效果，而非瞬间跳转

#### 2.1.4 当前位置指示 (P1)
- **需求描述**：在侧边栏中标识当前用户浏览到的对话位置
- **具体要求**：
  - 自动追踪：根据页面滚动位置自动更新当前项
  - 视觉标识：当前查询项使用不同颜色/样式标识
  - 滚动同步：列表自动滚动以保持当前项可见

### 2.2 交互需求

#### 2.2.1 侧边栏展开/收起 (P0)
- 提供展开/收起按钮
- 记住用户的展开/收起状态

#### 2.2.2 列表项交互 (P1)
- 悬停效果：鼠标悬停时显示完整查询内容（Tooltip）
- 选中状态：点击后该项保持选中状态

#### 2.2.3 搜索过滤 (P2)
- 在侧边栏顶部提供搜索框
- 支持关键词过滤查询列表
- 实时搜索，无需按回车

### 2.3 性能需求

- **加载性能**：侧边栏初始化时间 < 500ms
- **滚动性能**：定位滚动响应时间 < 200ms
- **内存占用**：对长对话（>100 轮）保持流畅运行
- **兼容性**：不影响 ChatGPT 原有功能

## 3. 技术需求

### 3.1 平台支持
- Chrome 浏览器（最低版本：88+）
- Firefox 浏览器（最低版本：85+）
- Edge 浏览器（最低版本：88+）
- Safari 浏览器（可选）

### 3.2 技术选型
- **实现方式**：浏览器扩展 或 Tampermonkey/Violentmonkey 用户脚本
- **前端框架**：原生 JavaScript 或轻量级框架（如 Vue/React）
- **样式方案**：CSS/SCSS，支持暗色模式
- **存储方案**：localStorage 或 chrome.storage API

### 3.3 数据采集
- 监听 DOM 变化，实时捕获新的用户查询
- 识别用户消息与 AI 回复的区别
- 处理代码块、图片等特殊内容的显示

## 4. 用户界面设计

### 4.1 侧边栏布局
```
┌─────────────────────────┐
│ [收起按钮]  [搜索框]    │
├─────────────────────────┤
│ #1 第一个问题的内容...  │ ← 当前位置（高亮）
│ #2 第二个问题的内容...  │
│ #3 第三个问题非常非常... │
│ #4 第四个问题...        │
│ ...                     │
└─────────────────────────┘
```

### 4.2 视觉风格
- 背景色：与 ChatGPT 主题一致（支持浅色/深色模式）
- 字体：系统默认字体，字号 14px
- 间距：列表项间距 8px，内边距 12px
- 滚动条：自定义样式，与界面风格统一

## 5. 非功能需求

### 5.1 可用性
- 用户无需配置即可使用基本功能
- 提供简单的设置页面（位置、宽度、快捷键等）
- 首次使用时显示简单的引导提示

### 5.2 可维护性
- 代码结构清晰，模块化设计
- 添加必要的注释
- 预留扩展接口，便于后续功能添加

### 5.3 兼容性
- 兼容 ChatGPT 界面更新
- 不与其他常用插件冲突
- 降级方案：ChatGPT 界面变化时显示友好提示

### 5.4 安全性
- 不收集用户对话内容
- 不向外部服务器发送数据
- 所有数据仅在本地处理和存储

## 6. 验收标准

### 6.1 功能验收
- [ ] 侧边栏能够正常显示和隐藏
- [ ] 能够完整列出当前对话的所有用户查询
- [ ] 点击列表项能够准确定位到对应位置
- [ ] 当前位置指示准确无误
- [ ] 支持长对话（100+ 轮）流畅运行

### 6.2 性能验收
- [ ] 初始化加载时间 < 500ms
- [ ] 定位响应时间 < 200ms
- [ ] 100 轮对话时内存增长 < 50MB

### 6.3 兼容性验收
- [ ] 在 Chrome/Firefox/Edge 上功能正常
- [ ] 浅色和深色模式下显示正常
- [ ] 不影响 ChatGPT 原有功能

## 7. 项目计划

### 7.1 开发阶段
- **阶段一**：核心功能开发（侧边栏、列表、定位）- 1 周
- **阶段二**：交互优化（搜索、快捷键、设置）- 3 天
- **阶段三**：测试与优化 - 2 天

### 7.2 优先级定义
- **P0**：核心功能，必须实现
- **P1**：重要功能，应该实现
- **P2**：增强功能，可以延后实现

## 8. 后续规划

### 8.1 功能扩展
- 支持导出对话大纲
- 添加书签功能，标记重要对话
- 支持为查询添加标签/分类
- 支持多对话切换的历史记录

### 8.2 性能优化
- 虚拟滚动优化超长列表
- 懒加载优化性能
- 缓存机制优化响应速度

## 9. 附录

### 9.1 术语定义
- **Turn**：一轮对话，包含一次用户查询和一次 AI 回复
- **Query**：用户的提问或输入内容
- **定位**：页面滚动到指定的对话位置
